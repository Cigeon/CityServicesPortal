<div *ngIf="allPetitions.length === 0" class="spinner"></div>
<div *ngIf="allPetitions.length !== 0" class="container">
    <div class="table-wrapper">
        
        <div class="table-filter">
            <div class="row">
                <div class="col-sm-2">
                    <div class="show-entries row align-items-end">
                        <label>Показати</label>
                        <div class="btn-group" dropdown>
                            <button dropdownToggle type="button" class="btn btn-default dropdown-toggle" name="selectItemsPerPage">
                                {{itemsPerPage}}
                            </button>
                            <div>
                                <ul *dropdownMenu class="dropdown-menu" role="menu">
                                    <li *ngFor="let value of itemsPerPageList" role="menuitem">
                                        <a class="dropdown-item" (click)="setItemsPerPage(value)">{{value}}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-10">                    
                    <div class="filter-group row align-items-end">
                        <label>Пошук</label>
                        <input type="text" class="form-control" [(ngModel)]="searchQuery">
                        <label>
                            <a class="view" tooltip="Пошук" (click)="search()">
                                <fa-icon [icon]="faSearch" class="search-icon"></fa-icon>
                            </a>
                        </label>
                    </div>
                    <div class="filter-group  row align-items-end">
                        <label>Статус</label>
                        <div class="btn-group" dropdown>
                            <button dropdownToggle type="button" class="btn btn-default dropdown-toggle status-filter" name="status">
                                {{sStatus}}
                            </button>
                            <div>
                                <ul *dropdownMenu class="dropdown-menu overflow" role="menu">
                                    <li role="menuitem">
                                        <a class="dropdown-item" (click)="selectStatus('Всі')">Всі</a>
                                    </li>
                                    <li class="divider dropdown-divider"></li>
                                    <li *ngFor="let status of statuses" role="menuitem">
                                        <a class="dropdown-item" (click)="selectStatus(status)">{{status}}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group  row align-items-end">
                        <label>Категорія</label>
                        <div class="btn-group" dropdown>
                            <button dropdownToggle type="button" class="btn btn-default dropdown-toggle category" name="category">
                                {{sCategory}}
                            </button>
                            <div *ngIf="categories.length">
                                <ul *dropdownMenu class="dropdown-menu overflow" role="menu">
                                    <li role="menuitem">
                                        <a class="dropdown-item" (click)="selectCatagory('Всі')">Всі</a>
                                    </li>
                                    <li class="divider dropdown-divider"></li>
                                    <li *ngFor="let category of categories" role="menuitem">
                                        <a class="dropdown-item" (click)="selectCatagory(category.name)">{{category.name}}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <table class="table table-striped table-hover">
            <thead>
                <tr>                   
                    <th style="width: 300px">Назва петиції</th>
                    <th>Категорія</th>
                    <th>Зареєстрована</th>
                    <th>Статус</th>
                    <th>Підтримано</th>
                    <th>Деталі</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let petition of shownPetitions; index as i">                    
                    <td>{{petition.name}}</td>
                    <td>{{petition.category.name}}</td>
                    <td><span class="font-size-sm">{{petition.created |  date:'yyyy-MM-dd'}}</span></td>
                    <td><span [ngStyle]="{'color':getColor(petition.status)}">&#11044;&nbsp;&nbsp;</span>{{getName(petition.status)}}</td>
                    <td><span class="font-size-sm">{{petition.voters.length}}/{{votesCount}}</span></td>
                    <td><a class="view" tooltip="Переглянути петицію" (click)="showPetitionDetail(petition.id)">
                            <fa-icon class="arrow-icon" [icon]="faArrowAltCircleRight"></fa-icon>
                        </a>
                    </td>
                </tr>                
            </tbody>
        </table>
        <div class="clearfix">
            <div class="hint-text">Показано <b>{{shownPetitions.length}}</b> з <b>{{filteredPetitions.length}}</b> петицій</div>
            <div class="pagination">
                <pagination *ngIf="filteredPetitions.length > itemsPerPage"
                            [(ngModel)]="currentPage"
                            [totalItems]="filteredPetitions.length"
                            [maxSize]="5"
                            [itemsPerPage]="itemsPerPage"
                            previousText="Назад"
                            nextText="Вперед"
                            (pageChanged)="pageChanged($event)">
                </pagination>
            </div>
        </div>
    </div>
</div> 